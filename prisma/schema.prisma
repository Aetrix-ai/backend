generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id              Int               @id @default(autoincrement())
  email           String            @unique
  name            String
  password        String
  role            String            @default("STUDENT")
  bio             String?

  avatarId        Int?              @unique
  avatar          Media?            @relation("UserAvatar", fields: [avatarId], references: [id])

  github          String?
  linkedin        String?
  twitter         String?
  resume          String?

  achievements    Achievement[]
  skills          Skill[]
  projects        Project[]
  aetrixProjects  AetrixProject[]
  media           Media[]
}

model Skill {
  id     Int    @id @default(autoincrement())
  name   String
  level  String

  userId Int
  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model Achievement {
  id          Int      @id @default(autoincrement())
  title       String
  description String
  date        DateTime

  userId      Int
  user        User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  media       Media[]
}

model Project {
  id             Int      @id @default(autoincrement())
  title          String
  description    String
  demoLink       String?
  repoLink       String?
  techStack      String[]
  additionalInfo String?

  userId         Int
  owner          User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  media          Media[]
}

model AetrixProject {
  id          Int     @id @default(autoincrement())
  type        String  // portfolio | event
  title       String
  description String?
  repoLink    String?
  deployLink  String?

  userId      Int?
  user        User?   @relation(fields: [userId], references: [id], onDelete: SetNull)
}

model Media {
  id             Int          @id @default(autoincrement())
  type           MediaType
  fileId         String
  url            String
  additional     String?

  userId         Int?
  user           User?        @relation(fields: [userId], references: [id], onDelete: Cascade)

  projectId      Int?
  project        Project?     @relation(fields: [projectId], references: [id], onDelete: Cascade)

  achievementId  Int?
  achievement    Achievement? @relation(fields: [achievementId], references: [id], onDelete: Cascade)

  avatarUser     User?        @relation("UserAvatar")
}

enum MediaType {
  IMAGE
  VIDEO
}
